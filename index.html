<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIPLOMATIC HUB PRO</title>
    <style>
        :root { --gold: #ffd700; --dark: #050505; }
        body { background: #000; color: white; font-family: sans-serif; text-align: center; margin: 0; padding: 20px; }
        .container { max-width: 400px; margin: auto; }
        .gold-text { color: var(--gold); text-shadow: 0 0 10px var(--gold); font-size: 2rem; }
        .game-card { 
            background: rgba(255,255,255,0.05); border: 1px solid var(--gold); 
            padding: 20px; margin: 15px 0; border-radius: 15px; width: 100%; 
            color: white; font-size: 1.1rem; cursor: pointer; transition: 0.3s;
        }
        .game-card:hover { background: rgba(255,215,0,0.1); }
        .action-btn { background: var(--gold); color: black; border: none; padding: 15px; border-radius: 10px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .hidden { display: none !important; }
        .glass-box { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 15px; border: 1px dashed var(--gold); margin: 20px 0; }
        input { width: 100%; padding: 12px; margin-top: 10px; border-radius: 8px; border: 1px solid #444; background: #222; color: white; box-sizing: border-box; }
    </style>
</head>
<body>

    <div class="container">
        <h1 class="gold-text">DIPLOMATIC HUB</h1>

        <div id="connection-screen" class="screen">
            <button class="game-card" onclick="showScreen('online-lobby')">ğŸŒ Ù„Ø¹Ø¨ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</button>
            <button class="game-card" onclick="showScreen('category-screen')">ğŸ  Ù„Ø¹Ø¨ Ù…Ø­Ù„ÙŠ</button>
        </div>

        <div id="online-lobby" class="screen hidden">
            <button class="action-btn" onclick="createNewRoom()">â• Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
            <p style="margin:20px 0; color:#888;">Ø£Ùˆ</p>
            <input type="text" id="room-input" placeholder="Ø§Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©">
            <button class="game-card" onclick="joinRoom()">ğŸ”— Ø¯Ø®ÙˆÙ„ ØºØ±ÙØ©</button>
            <button onclick="showScreen('connection-screen')" style="background:none; border:none; color:var(--gold); cursor:pointer; margin-top:10px;">Ø±Ø¬ÙˆØ¹</button>
        </div>

        <div id="category-screen" class="screen hidden">
            <h3>Ø§Ø®ØªØ± Ø§Ù„Ù„Ø¹Ø¨Ø©</h3>
            <button class="game-card" onclick="setGame('kora')">âš½ ØªØ­Ø¯ÙŠ Ø§Ù„ÙƒÙˆØ±Ø©</button>
            <button class="game-card" onclick="setGame('fawazir')">ğŸŒ™ ÙÙˆØ§Ø²ÙŠØ± Ø±Ù…Ø¶Ø§Ù†</button>
            <button class="game-card" onclick="setGame('spy')">ğŸ•µï¸ Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ØŸ</button>
        </div>

        <div id="setup-screen" class="screen hidden">
            <p>Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†:</p>
            <input type="number" id="p-count" value="2" min="2" max="10" onchange="genInputs()">
            <div id="names-box">
                <input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ 1" class="p-name-in">
                <input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ 2" class="p-name-in">
            </div>
            <button class="action-btn" onclick="startBattle()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨</button>
        </div>

        <div id="game-screen" class="screen hidden">
            <p class="gold-text" style="font-size: 1.2rem;">Ø¯ÙˆØ±: <span id="player-display"></span></p>
            <div class="glass-box">
                <p id="question-text"></p>
                <p id="answer-text" class="hidden" style="color:#00ff88; margin-top:10px;"></p>
            </div>
            <button id="show-btn" class="action-btn" onclick="revealAnswer()">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</button>
            <div id="score-btns" class="hidden" style="display:flex; gap:10px;">
                <button class="action-btn" style="background:#28a745;" onclick="handleNext(true)">ØµØ­ âœ…</button>
                <button class="action-btn" style="background:#dc3545;" onclick="handleNext(false)">Ø®Ø·Ø£ âŒ</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAESCjnKsQxNX_IKH9Fm_ePpIsbb9C_NsE",
            authDomain: "diplomatic-games.firebaseapp.com",
            projectId: "diplomatic-games",
            storageBucket: "diplomatic-games.firebasestorage.app",
            messagingSenderId: "726415224604",
            appId: "1:726415224604:web:3f436ef230254a5ee914d9",
            databaseURL: "https://diplomatic-games-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let game = { type: '', players: [], scores: {}, currentIdx: 0, round: 0 };
        const data = {
            kora: [{q:"Ù‡Ø¯Ø§Ù Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", a:"Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ"}, {q:"Ø¨Ø·Ù„ 2022ØŸ", a:"Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†"}],
            fawazir: [{q:"ÙŠÙƒØªØ¨ ÙˆÙ„Ø§ ÙŠÙ‚Ø±Ø£ØŸ", a:"Ø§Ù„Ù‚Ù„Ù…"}],
            spy: ["Ù…Ø·Ø§Ø±", "Ù…Ø³ØªØ´ÙÙ‰", "Ù…Ù„Ø¹Ø¨"]
        };

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙ†Ù‚Ù„
        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function createNewRoom() {
            const rId = Math.random().toString(36).substring(2, 6).toUpperCase();
            db.ref('rooms/' + rId).set({ status: 'waiting' }).then(() => {
                alert("ÙƒÙˆØ¯ ØºØ±ÙØªÙƒ: " + rId);
                showScreen('category-screen');
            });
        }

        function setGame(t) { game.type = t; showScreen('setup-screen'); }

        function genInputs() {
            const n = document.getElementById('p-count').value;
            const box = document.getElementById('names-box');
            box.innerHTML = '';
            for(let i=1; i<=n; i++) box.innerHTML += `<input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ ${i}" class="p-name-in">`;
        }

        function startBattle() {
            const ins = document.querySelectorAll('.p-name-in');
            game.players = Array.from(ins).map(i => i.value || "Ù„Ø§Ø¹Ø¨");
            game.players.forEach(p => game.scores[p] = 0);
            showScreen('game-screen');
            loadQ();
        }

        function loadQ() {
            document.getElementById('player-display').innerText = game.players[game.currentIdx];
            document.getElementById('answer-text').classList.add('hidden');
            document.getElementById('score-btns').classList.add('hidden');
            document.getElementById('show-btn').classList.remove('hidden');
            
            if(game.type === 'spy') {
                document.getElementById('question-text').innerText = "Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ø³Ø±ÙŠ: " + data.spy[Math.floor(Math.random()*3)];
                document.getElementById('answer-text').innerText = "Ø§Ù„Ø¬Ø§Ø³ÙˆØ³ Ù„Ø§Ø²Ù… ÙŠØ®Ù…Ù†!";
            } else {
                const item = data[game.type][game.round % data[game.type].length];
                document.getElementById('question-text').innerText = item.q;
                document.getElementById('answer-text').innerText = "Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: " + item.a;
            }
        }

        function revealAnswer() {
            document.getElementById('answer-text').classList.remove('hidden');
            document.getElementById('show-btn').classList.add('hidden');
            document.getElementById('score-btns').classList.remove('hidden');
            document.getElementById('score-btns').style.display = 'flex';
        }

        function handleNext(win) {
            if(win) game.scores[game.players[game.currentIdx]]++;
            game.currentIdx++;
            if(game.currentIdx >= game.players.length) { game.currentIdx = 0; game.round++; }
            if(game.round < 5) loadQ(); else alert("Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!");
        }
    </script>
</body>
</html>
