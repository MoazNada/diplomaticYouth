<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIPLOMATIC HUB - MULTI-ANS</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app" class="container">
        <h1 class="gold-text">DIPLOMATIC HUB</h1>

        <div id="category-screen" class="screen">
            <h3>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªØ­Ø¯ÙŠ</h3>
            <button class="game-card" onclick="setGame('kora')">âš½ ÙƒÙˆØ±Ø© (20)</button>
            <button class="game-card" onclick="setGame('fawazir')">ğŸŒ™ ÙÙˆØ§Ø²ÙŠØ± (20)</button>
            <button class="game-card" onclick="setGame('no_repeat')">ğŸš« Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø± (20)</button>
            <button class="game-card" onclick="setGame('what_if')">ğŸ¤” Ù„Ùˆ ÙƒÙ†Øª Ù…ÙƒØ§Ù†Ùƒ (20)</button>
            <div style="margin-top:20px;">
                <select id="q-count-select" class="action-btn" style="background:#222; color:white;">
                    <option value="10">10 Ø£Ø³Ø¦Ù„Ø©</option>
                    <option value="20" selected>20 Ø³Ø¤Ø§Ù„</option>
                </select>
            </div>
        </div>

        <div id="online-setup-screen" class="screen hidden">
            <input type="text" id="user-name" placeholder="Ø§Ø³Ù…Ùƒ">
            <button class="action-btn" onclick="initRoom('create')">â• Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ©</button>
            <input type="text" id="join-input" placeholder="ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©">
            <button class="game-card" onclick="initRoom('join')">ğŸ”— Ø§Ù†Ø¶Ù…Ø§Ù…</button>
            <button class="back-nav-btn" onclick="showScreen('category-screen')">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
        </div>

        <div id="lobby-screen" class="screen hidden">
            <h1 id="room-display" class="gold-text" style="font-size: 3rem;"></h1>
            <div class="glass-box"><div id="players-list"></div></div>
            <button id="host-start-btn" class="action-btn hidden" onclick="triggerStart()">Ø§Ø¨Ø¯Ø£ ğŸš€</button>
        </div>

        <div id="game-screen" class="screen hidden">
            <div class="timer-wrapper"><div id="timer-bar"></div></div>
            <p id="q-info" style="color:var(--gold);"></p>
            <div class="glass-box"><h3 id="question-text">...</h3></div>
            <div id="input-zone">
                <input type="text" id="ans-input" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ...">
                <button class="action-btn" onclick="submitProcess()">Ø¥Ø±Ø³Ø§Ù„ âœ…</button>
            </div>
            <div id="instant-feedback" class="hidden" style="font-size: 1.2rem; margin-top:10px;"></div>
        </div>

        <div id="result-screen" class="screen hidden">
            <h3 class="gold-text">Ø§Ù„ØªØ±ØªÙŠØ¨ ğŸ†</h3>
            <div id="leaderboard" class="glass-box"></div>
            <div class="glass-box" style="border: 1px solid #00ff88;">
                <p>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© Ø§Ù„Ù…Ù…ÙƒÙ†Ø©:</p>
                <h2 id="correct-reveal" style="color:#00ff88; font-size: 1.2rem;"></h2>
            </div>
            <div id="host-controls" class="hidden">
                <button class="action-btn" onclick="triggerStart()">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ â¡ï¸</button>
                <button class="game-card" onclick="location.reload()">ğŸ  Ø¥Ù†Ù‡Ø§Ø¡</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAESCjnKsQxNX_IKH9Fm_ePpIsbb9C_NsE",
            authDomain: "diplomatic-games.firebaseapp.com",
            projectId: "diplomatic-games",
            storageBucket: "diplomatic-games.firebasestorage.app",
            messagingSenderId: "726415224604",
            appId: "1:726415224604:web:3f436ef230254a5ee914d9",
            databaseURL: "https://diplomatic-games-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        let me = { name: '', room: '', isHost: false, gameType: '', maxQ: 20, score: 0 };
        
        // Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù…Ø¹ Ø¯Ø¹Ù… Ù…ØµÙÙˆÙØ© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª [ans1, ans2, ...]
        const dataBank = {
            kora: [
                {q:"Ù…Ù† Ù‡Ø¯Ø§Ù Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØŸ", a:["Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ", "ÙƒØ±ÙŠØ³ØªÙŠØ§Ù†Ùˆ", "Ø§Ù„Ø¯ÙˆÙ†"]},
                {q:"Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù‚Ø±Ù† ÙÙŠ Ø£ÙØ±ÙŠÙ‚ÙŠØ§ØŸ", a:["Ø§Ù„Ø§Ù‡Ù„ÙŠ", "Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø§Ù‡Ù„ÙŠ", "Ø§Ù„Ù‚Ø§Ø±Ø©"]},
                {q:"Ø¨Ø·Ù„ Ù…ÙˆÙ†Ø¯ÙŠØ§Ù„ 2022ØŸ", a:["Ø§Ù„Ø§Ø±Ø¬Ù†ØªÙŠÙ†", "Ø§Ø±Ø¬Ù†ØªÙŠÙ†"]},
                {q:"Ù…Ø¯Ø±Ø¨ Ù…Ø§Ù†Ø´Ø³ØªØ± Ø³ÙŠØªÙŠØŸ", a:["ØºÙˆØ§Ø±Ø¯ÙŠÙˆÙ„Ø§", "Ø¨Ø¨", "Ø¨ÙŠØ¨"]},
                {q:"Ø£ÙŠÙ† ÙŠÙ„Ø¹Ø¨ Ù…Ø­Ù…Ø¯ ØµÙ„Ø§Ø­ØŸ", a:["Ù„ÙŠÙØ±Ø¨ÙˆÙ„", "Ù„ÙŠÙØ±"]},
                {q:"Ù…Ù„Ù‚Ø¨ Ø¨Ø§Ù„Ø¨Ø±ØºÙˆØ«ØŸ", a:["Ù…ÙŠØ³ÙŠ", "Ù„ÙŠÙˆÙ†ÙŠÙ„"]},
                {q:"Ø¨Ø·Ù„ ÙŠÙˆØ±Ùˆ 2024ØŸ", a:["Ø§Ø³Ø¨Ø§Ù†ÙŠØ§", "Ø§Ù„Ø£Ø³Ø¨Ø§Ù†"]},
                {q:"Ø£ÙŠÙ† ÙŠÙ„Ø¹Ø¨ Ù…Ø¨Ø§Ø¨ÙŠØŸ", a:["Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯", "Ø§Ù„Ø±ÙŠØ§Ù„", "Ù…Ø¯Ø±ÙŠØ¯"]},
                {q:"Ù…Ù„Ø¹Ø¨ Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©ØŸ", a:["ÙƒØ§Ù…Ø¨ Ù†Ùˆ", "Ø³Ø¨ÙˆØªÙŠÙØ§ÙŠ"]},
                {q:"Ù„Ù‚Ø¨ Ù…Ù†ØªØ®Ø¨ Ø§Ù„Ù…ØºØ±Ø¨ØŸ", a:["Ø§Ø³ÙˆØ¯ Ø§Ù„Ø§Ø·Ù„Ø³", "Ø§Ù„Ù…ØºØ±Ø¨"]},
                {q:"Ù…Ù† Ù‡Ùˆ Ø§Ù„Ø¸Ø§Ù‡Ø±Ø©ØŸ", a:["Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„ÙŠ", "Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ", "Ù†Ø§Ø²Ø§Ø±ÙŠÙˆ"]},
                {q:"Ø¨Ø·Ù„ Ø§Ù„Ù€ UCL 2024ØŸ", a:["Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯", "Ø§Ù„Ù…Ù„ÙƒÙŠ"]},
                {q:"Ø£Ø³Ø±Ø¹ Ù„Ø§Ø¹Ø¨ Ø­Ø§Ù„ÙŠØ§ØŸ", a:["Ù…Ø¨Ø§Ø¨ÙŠ", "ÙƒÙŠÙ„ÙŠØ§Ù†"]},
                {q:"Ø¹Ø¯Ø¯ ØªØ¨Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø§ØªØ´ØŸ", a:["5", "Ø®Ù…Ø³Ø©"]},
                {q:"Ù…ÙˆÙ‚Ø¹ Ù…Ù„Ø¹Ø¨ Ù…Ø§Ø±Ø§ÙƒØ§Ù†Ø§ØŸ", a:["Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„", "Ø¨Ø±Ø§Ø²ÙŠÙ„"]},
                {q:"Ø¨Ø·Ù„ Ø§Ù„ÙƒØ§Ù† 2023ØŸ", a:["Ø³Ø§Ø­Ù„ Ø§Ù„Ø¹Ø§Ø¬", "ÙƒÙˆØª Ø¯ÙŠÙÙˆØ§Ø±"]},
                {q:"ÙØ§Ø¦Ø² Ù…ÙˆÙ†Ø¯ÙŠØ§Ù„ 2010ØŸ", a:["Ø§Ø³Ø¨Ø§Ù†ÙŠØ§", "Ø§Ø³Ø¨Ø§Ù†ÙŠØ§"]},
                {q:"Ø£ÙŠÙ† Ø³ÙŠÙ„Ø¹Ø¨ ÙÙŠÙ†ÙŠØ³ÙŠÙˆØ³ØŸ", a:["Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯", "Ø§Ù„Ø±ÙŠØ§Ù„"]},
                {q:"ØµØ§Ø­Ø¨ Ø§Ù„Ù‚Ø§Ø¶ÙŠØ© Ù…Ù…ÙƒÙ†ØŸ", a:["Ø§ÙØ´Ø©", "Ù‚ÙØ´Ø©", "Ù…Ø­Ù…Ø¯ Ù…Ø¬Ø¯ÙŠ"]},
                {q:"Ù…Ø³ØªØ¶ÙŠÙ Ù…ÙˆÙ†Ø¯ÙŠØ§Ù„ 2026ØŸ", a:["Ø§Ù…Ø±ÙŠÙƒØ§", "Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©", "ÙƒÙ†Ø¯Ø§", "Ø§Ù„Ù…ÙƒØ³ÙŠÙƒ"]}
            ],
            fawazir: [
                {q:"Ø´ÙŠØ¡ ÙŠØ·ÙŠØ± Ø¨Ù„Ø§ Ø£Ø¬Ù†Ø­Ø©ØŸ", a:["Ø§Ù„Ø¯Ø®Ø§Ù†", "Ø¯Ø®Ø§Ù†"]},
                {q:"Ù„Ù‡ Ø£Ø³Ù†Ø§Ù† ÙˆÙ„Ø§ ÙŠØ¹Ø¶ØŸ", a:["Ø§Ù„Ù…Ø´Ø·", "Ù…Ø´Ø·"]},
                {q:"Ø´ÙŠØ¡ ÙŠÙƒØªØ¨ ÙˆÙ„Ø§ ÙŠÙ‚Ø±Ø£ØŸ", a:["Ø§Ù„Ù‚Ù„Ù…", "Ù‚Ù„Ù…"]},
                {q:"ÙŠØ­ÙØ¸ Ø§Ù„Ù…Ø§Ø¡ ÙˆÙ‡Ùˆ Ù…Ø«Ù‚ÙˆØ¨ØŸ", a:["Ø§Ù„Ø§Ø³ÙÙ†Ø¬", "Ø§Ø³ÙÙ†Ø¬"]},
                {q:"ÙŠØ³Ù…Ø¹ Ø¨Ù„Ø§ Ø£Ø°Ù† ÙˆÙŠØªÙƒÙ„Ù… Ø¨Ù„Ø§ Ù„Ø³Ø§Ù†ØŸ", a:["Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†", "Ø§Ù„Ù‡Ø§ØªÙ", "Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"]},
                {q:"Ù„Ù‡ Ø±Ø£Ø³ ÙˆÙ„Ø§ Ø¹ÙŠÙ† Ù„Ù‡ØŸ", a:["Ø§Ù„Ø¯Ø¨ÙˆØ³", "Ù…Ø³Ù…Ø§Ø±"]},
                {q:"ÙƒÙ„Ù…Ø§ Ø²Ø§Ø¯ Ù†Ù‚ØµØŸ", a:["Ø§Ù„Ø¹Ù…Ø±", "Ø¹Ù…Ø±"]},
                {q:"Ù„Ø§ ÙŠØ¨Ø±Ø¯ ÙÙŠ Ø§Ù„Ø«Ù„Ø§Ø¬Ø©ØŸ", a:["Ø§Ù„ÙÙ„ÙÙ„", "Ø´Ø·Ø©"]},
                {q:"ÙŠØªØ­Ø±Ùƒ Ø­ÙˆÙ„Ùƒ ÙˆÙ„Ø§ ØªØ±Ø§Ù‡ØŸ", a:["Ø§Ù„Ù‡ÙˆØ§Ø¡", "Ø±ÙŠØ­"]},
                {q:"Ù„Ù‡ Ø¹ÙŠÙ† ÙˆÙ„Ø§ ÙŠØ±Ù‰ØŸ", a:["Ø§Ù„Ø§Ø¨Ø±Ø©", "Ø§Ø¨Ø±Ø©"]},
                {q:"Ù‚Ù„Ø¨Ù‡ ÙŠØ£ÙƒÙ„ Ù‚Ø´Ø±Ù‡ØŸ", a:["Ø§Ù„Ø´Ù…Ø¹Ø©", "Ø´Ù…Ø¹Ø©"]},
                {q:"ÙƒÙ… Ø´Ù‡Ø± ÙÙŠÙ‡ 28 ÙŠÙˆÙ…ØŸ", a:["ÙƒÙ„ Ø§Ù„Ø´Ù‡ÙˆØ±", "12"]},
                {q:"ØªØ°Ø¨Ø­Ù‡ ÙˆØªØ¨ÙƒÙŠ Ø¹Ù„ÙŠÙ‡ØŸ", a:["Ø§Ù„Ø¨ØµÙ„", "Ø¨ØµÙ„"]},
                {q:"ÙƒÙ„Ù…Ø© ØªØ¨Ø·Ù„ Ù„Ùˆ Ù†Ø·Ù‚Ù†Ø§ Ø¨Ù‡Ø§ØŸ", a:["Ø§Ù„ØµÙ…Øª", "Ø³ÙƒÙˆØª"]},
                {q:"ÙŠØ³ØªØ®Ø¯Ù…Ù‡ Ø§Ù„Ù†Ø§Ø³ Ø£ÙƒØ«Ø± Ù…Ù†ÙƒØŸ", a:["Ø§Ø³Ù…Ùƒ", "Ø§Ù„Ø§Ø³Ù…"]},
                {q:"Ù…Ø¯Ù† Ø¨Ù„Ø§ Ø¨ÙŠÙˆØªØŸ", a:["Ø§Ù„Ø®Ø±ÙŠØ·Ø©", "Ø®Ø±ÙŠØ·Ø©"]},
                {q:"Ù„Ø§ ÙŠÙ…Ø´ÙŠ Ø¥Ù„Ø§ Ø¨Ø§Ù„Ø¶Ø±Ø¨ØŸ", a:["Ø§Ù„Ù…Ø³Ù…Ø§Ø±", "Ù…Ø³Ù…Ø§Ø±"]},
                {q:"ÙŠÙ‚Ø±ØµÙƒ ÙˆÙ„Ø§ ØªØ±Ø§Ù‡ØŸ", a:["Ø§Ù„Ø¬ÙˆØ¹", "Ø¨Ø±Ø¯"]},
                {q:"Ù„Ù‡ Ø£Ø±Ø¬Ù„ ÙˆÙ„Ø§ ÙŠÙ…Ø´ÙŠØŸ", a:["Ø§Ù„ÙƒØ±Ø³ÙŠ", "Ø·Ø§ÙˆÙ„Ø©"]},
                {q:"ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù„ÙŠÙ„ ÙˆÙŠØ®ØªÙÙŠ ÙÙŠ Ø§Ù„Ù†Ù‡Ø§Ø±ØŸ", a:["Ø§Ù„Ù‚Ù…Ø±", "Ù†Ø¬ÙˆÙ…"]}
            ],
            no_repeat: [
                {q:"Ø§Ø°ÙƒØ± ÙØ§ÙƒÙ‡Ø© ØµÙŠÙÙŠØ©", a:["Ø¨Ø·ÙŠØ®", "Ù…Ø§Ù†Ø¬Ùˆ", "Ø¹Ù†Ø¨", "ØªÙŠÙ†"]},
                {q:"Ø§Ø°ÙƒØ± Ù…Ø§Ø±ÙƒØ© Ù…ÙˆØ¨Ø§ÙŠÙ„Ø§Øª", a:["Ø§ÙŠÙÙˆÙ†", "Ø³Ø§Ù…Ø³ÙˆÙ†Ø¬", "Ø´Ø§ÙˆÙ…ÙŠ", "Ù‡ÙˆØ§ÙˆÙŠ"]},
                {q:"Ø¯ÙˆÙ„Ø© Ø£ÙØ±ÙŠÙ‚ÙŠØ©", a:["Ù…ØµØ±", "Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", "ØªÙˆÙ†Ø³", "Ù†ÙŠØ¬ÙŠØ±ÙŠØ§"]},
                {q:"Ù†Ø§Ø¯ÙŠ Ø£ÙˆØ±ÙˆØ¨ÙŠ", a:["Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯", "Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©", "Ù„ÙŠÙØ±Ø¨ÙˆÙ„", "Ø¨Ø§ÙŠØ±Ù†"]},
                {q:"Ø®Ø¶Ø§Ø± ÙˆØ±Ù‚ÙŠ", a:["Ø¬Ø±Ø¬ÙŠØ±", "Ø®Ø³", "Ø³Ø¨Ø§Ù†Ø®", "Ø¨Ù‚Ø¯ÙˆÙ†Ø³"]},
                {q:"Ø§Ø³Ù… Ù†Ø¨ÙŠ", a:["Ù…Ø­Ù…Ø¯", "Ù…ÙˆØ³Ù‰", "Ø¹ÙŠØ³Ù‰", "Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ…"]},
                {q:"Ø¹Ø§ØµÙ…Ø© Ø¹Ø§Ù„Ù…ÙŠØ©", a:["Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©", "Ù„Ù†Ø¯Ù†", "Ø¨Ø§Ø±ÙŠØ³", "Ù…Ø¯Ø±ÙŠØ¯"]},
                {q:"Ù„Ø§Ø¹Ø¨ ÙƒÙˆØ±Ø© Ø¹Ø§Ù„Ù…ÙŠ", a:["Ù…ÙŠØ³ÙŠ", "Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ", "ØµÙ„Ø§Ø­", "Ù†ÙŠÙ…Ø§Ø±"]},
                {q:"ÙƒÙˆÙƒØ¨ Ø³ÙŠØ§Ø±", a:["Ø§Ù„Ù…Ø±ÙŠØ®", "Ø§Ù„Ù…Ø´ØªØ±ÙŠ", "Ø§Ù„Ø²Ù‡Ø±Ø©", "Ø²Ø­Ù„"]},
                {q:"ÙÙŠÙ„Ù… ÙƒØ±ØªÙˆÙ†", a:["ØªÙˆÙ… ÙˆØ¬ÙŠØ±ÙŠ", "Ø³Ø¨ÙˆÙ†Ø¬ Ø¨ÙˆØ¨", "Ø³ÙŠÙ…Ø¨Ø§"]},
                {q:"ØªØ·Ø¨ÙŠÙ‚ Ù‡Ø§ØªÙ", a:["ÙˆØ§ØªØ³Ø§Ø¨", "ØªÙŠÙƒ ØªÙˆÙƒ", "Ø§Ù†Ø³ØªØ¬Ø±Ø§Ù…"]},
                {q:"Ø­ÙŠÙˆØ§Ù† ØºØ§Ø¨Ø©", a:["Ø§Ø³Ø¯", "Ù†Ù…Ø±", "ÙÙ‡Ø¯", "Ø°Ø¦Ø¨"]},
                {q:"Ù„ØºØ© Ø¨Ø±Ù…Ø¬Ø©", a:["Ø¬Ø§ÙØ§", "Ø¨Ø§ÙŠØ«ÙˆÙ†", "Ø³ÙŠ Ø¨Ù„Ø³", "Ø§ØªØ´ ØªÙŠ Ø§Ù… Ø§Ù„"]},
                {q:"Ù…Ø§Ø¯Ø© Ø¹Ù„Ù…ÙŠØ©", a:["ÙÙŠØ²ÙŠØ§Ø¡", "ÙƒÙŠÙ…ÙŠØ§Ø¡", "Ø§Ø­ÙŠØ§Ø¡", "ÙÙ„Ùƒ"]},
                {q:"Ø¹Ù…Ù„Ø©", a:["Ø¯ÙˆÙ„Ø§Ø±", "Ø¬Ù†ÙŠÙ‡", "ÙŠÙˆØ±Ùˆ", "Ø±ÙŠØ§Ù„"]},
                {q:"ØµØ­Ø§Ø¨ÙŠ", a:["Ø¹Ù„ÙŠ", "Ø¹Ù…Ø±", "Ø¹Ø«Ù…Ø§Ù†", "Ø®Ø§Ù„Ø¯"]},
                {q:"Ù„ÙˆÙ†", a:["Ø§Ø­Ù…Ø±", "Ø§Ø²Ø±Ù‚", "Ø§Ø®Ø¶Ø±", "Ø§ØµÙØ±"]},
                {q:"Ù…ÙˆÙ‚Ø¹ ØªÙˆØ§ØµÙ„", a:["ÙÙŠØ³Ø¨ÙˆÙƒ", "ØªÙˆÙŠØªØ±", "Ù„ÙŠÙ†ÙƒØ¯ Ø§Ù†"]},
                {q:"Ø¹Ø¶Ùˆ Ø¨Ø§Ù„Ø¬Ø³Ù…", a:["Ø¹ÙŠÙ†", "Ù‚Ù„Ø¨", "ÙƒØ¨Ø¯", "Ø±Ø¦Ø©"]},
                {q:"Ù…Ø¯ÙŠÙ†Ø© Ù…ØµØ±ÙŠØ©", a:["Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©", "Ø§Ù„Ø¬ÙŠØ²Ø©", "Ø§Ø³ÙˆØ§Ù†", "Ø§Ù„Ø§Ù‚ØµØ±"]}
            ],
            what_if: [
                {q:"Ù„Ùˆ Ù„Ù‚ÙŠØª Ù…Ø­ÙØ¸Ø©ØŸ", a:["Ù‡Ø±Ø¬Ø¹Ù‡Ø§", "Ø£Ø³Ù„Ù…Ù‡Ø§ Ù„Ù„Ø´Ø±Ø·Ø©", "Ø£Ø¨Ø­Ø« Ø¹Ù† ØµØ§Ø­Ø¨Ù‡Ø§"]},
                {q:"Ù„Ùˆ Ø¨Ù‚ÙŠØª Ø±Ø¦ÙŠØ³ØŸ", a:["Ù‡Ø¨Ù†ÙŠ Ù…Ø¯Ø§Ø±Ø³", "Ù‡ÙˆØ²Ø¹ ÙÙ„ÙˆØ³", "Ù‡ØµÙ„Ø­ Ø§Ù„Ø·Ø±Ù‚"]},
                {q:"Ù„Ùˆ ØªÙ‚Ø¯Ø± ØªØ·ÙŠØ±ØŸ", a:["Ù‡Ø³Ø§ÙØ±", "Ù‡Ø´ÙˆÙ Ø§Ù„Ø¹Ø§Ù„Ù…", "Ù‡Ø·ÙŠØ± ÙÙˆÙ‚ Ø§Ù„ØºÙŠÙˆÙ…"]},
                {q:"Ù„Ùˆ ÙƒØ³Ø¨Øª Ù…Ù„ÙŠÙˆÙ†ØŸ", a:["Ù‡Ø´ØªØ±ÙŠ Ø¨ÙŠØª", "Ù‡ØªØ¨Ø±Ø¹", "Ù‡ÙØªØ­ Ù…Ø´Ø±ÙˆØ¹"]},
                {q:"Ù„Ùˆ Ø¨Ù‚ÙŠØª ØºÙŠØ± Ù…Ø±Ø¦ÙŠØŸ", a:["Ù‡Ø³Ù…Ø¹ Ø§Ù„Ø£Ø³Ø±Ø§Ø±", "Ù‡Ø¯Ø®Ù„ Ø§Ù„Ø³ÙŠÙ†Ù…Ø§", "Ù‡Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù†Ø§Ø³"]},
                {q:"Ù„Ùˆ Ø±Ø¬Ø¹Øª Ù„Ù„Ù…Ø§Ø¶ÙŠØŸ", a:["Ù‡Ø°Ø§ÙƒØ± Ø§ÙƒØªØ±", "Ù‡ØºÙŠØ± Ù‚Ø±Ø§Ø±Ø§ØªÙŠ", "Ù‡Ø´ÙˆÙ Ø¬Ø¯ÙŠ"]},
                {q:"Ù„Ùˆ Ù‚Ø§Ø¨Ù„Øª ØµÙ„Ø§Ø­ØŸ", a:["Ù‡ØªØµÙˆØ±", "Ù‡Ø·Ù„Ø¨ ØªÙŠØ´Ø±Øª", "Ù‡Ø´Ø¬Ø¹Ù‡"]},
                {q:"Ù„Ùˆ Ø¹Ø´Øª ÙÙŠ Ø§Ù„Ù…Ø±ÙŠØ®ØŸ", a:["Ù‡Ø¨Ù†ÙŠ Ø¨ÙŠØª", "Ù‡Ø³ØªÙƒØ´Ù", "Ù‡Ù„Ø¨Ø³ Ø¨Ø¯Ù„Ø© ÙØ¶Ø§Ø¡"]},
                {q:"Ù„Ùˆ Ø¨Ù‚ÙŠØª Ù…Ø¯ÙŠØ±ØŸ", a:["Ù‡ØºÙŠØ± Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†", "Ù‡Ø²ÙˆØ¯ Ø§Ù„Ø±ÙˆØ§ØªØ¨", "Ù‡Ø¹Ù…Ù„ Ø­ÙÙ„Ø©"]},
                {q:"Ù„Ùˆ Ù…Ø¹Ø§Ùƒ Ù…ØµØ¨Ø§Ø­ØŸ", a:["Ù‡Ø·Ù„Ø¨ ØµØ­Ø©", "Ù‡Ø·Ù„Ø¨ Ù…Ø§Ù„", "Ù‡Ø·Ù„Ø¨ Ø³Ø¹Ø§Ø¯Ø©"]},
                {q:"Ù„Ùˆ Ø¨Ù‚ÙŠØª Ù…Ø¯Ø±Ø¨ØŸ", a:["Ù‡Ø§Ø®Ø¯ Ø§Ù„Ø¯ÙˆØ±ÙŠ", "Ù‡Ø¬ÙŠØ¨ Ù„Ø¹ÙŠØ¨Ø©", "Ù‡Ø·ÙˆØ± Ø§Ù„ÙØ±ÙŠÙ‚"]},
                {q:"Ù„Ùˆ ØºÙŠØ±Øª Ø§Ø³Ù…ÙƒØŸ", a:["Ù‡Ø®ØªØ§Ø± Ø§Ø³Ù… ÙØ®Ù…", "Ù…Ø´ Ù‡ØºÙŠØ±Ù‡", "Ù‡Ø³Ù…ÙŠÙ‡ Ø±Ø¹Ø¯"]},
                {q:"Ù„Ùˆ Ù…Ø¹Ø§Ùƒ Ù…ÙØªØ§Ø­ØŸ", a:["Ù‡ÙØªØ­ Ø§Ù„ÙƒÙ†Ø²", "Ù‡Ø¹Ø±Ù Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø©", "Ù‡ÙØªØ­ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨"]},
                {q:"Ù„Ùˆ Ø¨Ù‚ÙŠØª Ø®Ø§Ø±Ù‚ØŸ", a:["Ù‡Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø¶Ø¹ÙØ§Ø¡", "Ù‡Ø·ÙŠØ±", "Ù‡Ø­Ù…ÙŠ Ø§Ù„Ù…Ø¯Ù†ÙŠÙŠÙ†"]},
                {q:"Ù„Ùˆ ÙÙ‡Ù…Øª Ø§Ù„Ø­ÙŠÙˆØ§Ù†ØŸ", a:["Ù‡ÙƒÙ„Ù… ÙƒÙ„Ø¨ÙŠ", "Ù‡Ø³Ø£Ù„ Ø§Ù„Ø·ÙŠÙˆØ±", "Ù‡ØµØ§Ø­Ø¨ Ø§Ù„Ø§Ø³Ø¯"]},
                {q:"Ù„Ùˆ Ø¹Ø´Øª ÙˆØ­Ø¯ÙƒØŸ", a:["Ù‡Ù‚Ø±Ø£ ÙƒØªØ¨", "Ù‡Ø²Ø±Ø¹ Ø§ÙƒÙ„", "Ù‡Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ù‡Ø¯ÙˆØ¡"]},
                {q:"Ù„Ùˆ Ø¨Ù‚ÙŠØª Ø·Ø¨Ø§Ø®ØŸ", a:["Ù‡Ø¹Ù…Ù„ ÙˆÙ„ÙŠÙ…Ø©", "Ù‡Ø®ØªØ±Ø¹ Ø§ÙƒÙ„Ø©", "Ù‡ÙØªØ­ Ù…Ø·Ø¹Ù…"]},
                {q:"Ù„Ùˆ Ø³Ø§ÙØ±Øª Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ØŸ", a:["Ù‡Ø¹Ø±Ù Ø§Ù„Ø§Ø®ØªØ±Ø§Ø¹Ø§Øª", "Ù‡Ø´ÙˆÙ ÙˆÙ„Ø§Ø¯ÙŠ", "Ù‡Ø¹Ø±Ù Ø§Ù„ØªØ§Ø±ÙŠØ®"]},
                {q:"Ù„Ùˆ Ø¨Ù‚ÙŠØª Ø·ÙÙ„ØŸ", a:["Ù‡Ù„Ø¹Ø¨ ÙƒÙˆØ±Ø©", "Ù…Ø´ Ù‡ÙÙƒØ± ÙÙŠ Ù‡Ù…ÙˆÙ…", "Ù‡Ù†Ø§Ù… ÙƒØªÙŠØ±"]},
                {q:"Ù„Ùˆ Ù…Ø¹Ø§Ùƒ Ø¢Ù„Ø© Ø²Ù…Ù†ØŸ", a:["Ù‡Ø±ÙˆØ­ Ø§Ù„ÙØ±Ø§Ø¹Ù†Ø©", "Ù‡Ø±ÙˆØ­ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„", "Ù‡Ø´ÙˆÙ Ø¨Ø§Ø¨Ù„"]}
            ]
        };

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        window.setGame = (g) => {
            me.gameType = g;
            me.maxQ = parseInt(document.getElementById('q-count-select').value);
            showScreen('online-setup-screen');
        };

        window.initRoom = (type) => {
            me.name = document.getElementById('user-name').value.trim() || "Ù„Ø§Ø¹Ø¨_" + Math.floor(Math.random()*99);
            me.room = type === 'create' ? Math.random().toString(36).substring(2,6).toUpperCase() : document.getElementById('join-input').value.toUpperCase();
            me.isHost = type === 'create';
            if(me.isHost) db.ref('party/' + me.room).set({ status: 'lobby', qIdx: 0, game: me.gameType, maxQ: me.maxQ, timer: 15 });
            db.ref('party/' + me.room + '/players/' + me.name).set({ score: 0, submitted: false });
            listen(); showScreen('lobby-screen');
        };

        function listen() {
            db.ref('party/' + me.room).on('value', (snap) => {
                const data = snap.val(); if(!data) return;
                document.getElementById('room-display').innerText = me.room;
                const pList = document.getElementById('players-list');
                const board = document.getElementById('leaderboard');
                pList.innerHTML = ""; board.innerHTML = "";
                let allDone = true; let count = 0;

                for(let p in data.players) {
                    count++;
                    pList.innerHTML += `<p>ğŸ‘¤ ${p}: ${data.players[p].score}</p>`;
                    board.innerHTML += `<p style="display:flex; justify-content:space-between;"><span>${p}</span><span>${data.players[p].score}Ù†</span></p>`;
                    if(!data.players[p].submitted) allDone = false;
                }

                if(allDone && count > 0 && data.status === 'playing' && me.isHost) {
                    db.ref('party/' + me.room).update({ status: 'results' });
                }

                if(data.status === 'playing') {
                    showScreen('game-screen');
                    document.getElementById('input-zone').classList.remove('hidden');
                    document.getElementById('instant-feedback').classList.add('hidden');
                    document.getElementById('q-info').innerText = `Ø³Ø¤Ø§Ù„ ${data.qIdx + 1} Ù…Ù† ${data.maxQ}`;
                    document.getElementById('question-text').innerText = dataBank[data.game][data.qIdx]?.q || "Ø§Ù†ØªÙ‡Ù‰!";
                    document.getElementById('timer-bar').style.width = (data.timer / 15 * 100) + "%";
                } else if(data.status === 'results') {
                    showScreen('result-screen');
                    const correctAnswers = dataBank[data.game][data.qIdx]?.a || [];
                    document.getElementById('correct-reveal').innerText = Array.isArray(correctAnswers) ? correctAnswers.join(" / ") : correctAnswers;
                    document.getElementById('host-controls').classList.toggle('hidden', !me.isHost);
                }
                if(me.isHost) document.getElementById('host-start-btn').classList.toggle('hidden', data.status !== 'lobby');
            });
        }

        window.submitProcess = () => {
            const val = document.getElementById('ans-input').value.trim().toLowerCase();
            db.ref('party/' + me.room).once('value', s => {
                const currentQ = dataBank[s.val().game][s.val().qIdx];
                const feedback = document.getElementById('instant-feedback');
                feedback.classList.remove('hidden');

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¶Ù…Ù† Ù…ØµÙÙˆÙØ© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ù…ÙƒÙ†Ø©
                const isCorrect = currentQ.a.some(ans => val.includes(ans.toLowerCase()) || ans.toLowerCase().includes(val));

                if(isCorrect && val !== "") {
                    feedback.innerHTML = "âœ… ØµØ­!"; feedback.style.color = "#00ff88";
                    me.score += 10;
                } else {
                    feedback.innerHTML = `âŒ Ø®Ø·Ø£! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ù…Ù…ÙƒÙ† ØªÙƒÙˆÙ†: ${currentQ.a[0]}`; feedback.style.color = "#ff4444";
                }
                db.ref('party/' + me.room + '/players/' + me.name).update({ score: me.score, submitted: true });
                document.getElementById('input-zone').classList.add('hidden');
                document.getElementById('ans-input').value = "";
            });
        };

        window.triggerStart = () => {
            db.ref('party/' + me.room).once('value', s => {
                let idx = s.val().status === 'results' ? s.val().qIdx + 1 : 0;
                if(idx >= s.val().maxQ) { alert("Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ØªØ­Ø¯ÙŠ!"); location.reload(); return; }
                for(let p in s.val().players) db.ref('party/'+me.room+'/players/'+p).update({submitted: false});
                db.ref('party/' + me.room).update({ status: 'playing', qIdx: idx, timer: 15 });
                let t = 15;
                let i = setInterval(() => {
                    t--; db.ref('party/' + me.room).update({ timer: t });
                    if(t <= 0) { clearInterval(i); db.ref('party/' + me.room).update({ status: 'results' }); }
                }, 1000);
            });
        };
    </script>
</body>
</html>
